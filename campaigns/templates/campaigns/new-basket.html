<!DOCTYPE html>
<html>

<head>
	<!--  meta tags -->
	<meta charset="utf-8">
	<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=0'>
	<meta name="google-site-verification" content="">
	<meta name="description" content="" />
	<meta name="keywords" content="" />

	<!-- Title -->
	<title>POP Ghana | New Basket</title>

	<script src="/static/plugins/dexie/dexie.js"></script>
	<!-- Bootstrap Css -->
	<link href="/static/plugins/bootstrap-4.3.1-dist/css/bootstrap.min.css" rel="stylesheet" />
	<!-- Animate Css-->
	<link rel="stylesheet" href="/static/css/animate.css">
	<!-- Dashboard Css -->
	<link href="/static/css/style.css" rel="stylesheet" />

	<!-- Font-awesome  Css -->
	<link href="/static/css/icons.css" rel="stylesheet" />

	<!--Horizontal Menu-->
	<link href="/static/plugins/horizontal/horizontal-menu/animation/fade-down.css" rel="stylesheet" />
	<link href="/static/plugins/horizontal/horizontal-menu/horizontal.css" rel="stylesheet" />

	<!--Select2 Plugin -->
	<link href="/static/plugins/select2/select2.min.css" rel="stylesheet" />

	<!-- Owl Theme css-->
	<link href="/static/plugins/owl-carousel/owl.carousel.css" rel="stylesheet" />

	<!-- Cookie css -->
	<link href="/static/plugins/cookie/cookie.css" rel="stylesheet">

	<!-- Custom scroll bar css-->
	<link href="/static/plugins/scroll-bar/jquery.mCustomScrollbar.css" rel="stylesheet" />

	<!-- COLOR-SKINS -->
	<link id="theme" rel="stylesheet" type="text/css" media="all" href="/static/color-skins/color-skins/color10.css" />
	<link href="https://www.pywe.org/static/css/animate.css" rel="stylesheet" />

	<!--Semantic UI css-->
	<link rel="stylesheet" href="/static/plugins/Semantic-UI-CSS/semantic.min.css">

</head>

<body>


	<!--Sliders Section-->
	<section>
		<div class="bannerimg cover-image bg-background3" data-image-src="/static/images/banners/banner2.jpg">
			<div class="header-text mb-0">
				<div class="container">
					<div class="text-center text-white">
						<h1>New Basket</h1>

						<ol class="breadcrumb text-center">
							<li class="breadcrumb-item"><a href="/">Home</a></li>
							<li class="breadcrumb-item"><a
									href="/campaigns/templates/campaigns/observation_session.html">Observation
									Session</a>
							</li>
							<li class="breadcrumb-item active text-white" aria-current="page">New Basket</li>
						</ol>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!--/Sliders Section-->

	<!--Patient data-section-->
	<br><br>
	<div class="ui container">

		<form id="basketForm" method="dialog" class="ui form">

			<div class="ui raised segments">
				<div class="ui segment">
					<div class="ui header">Patient</div>
				</div>
				<div class="ui secondary segment">
					<div class="fields">
						<div id="insurance" class="field">
							<label>Insurance scheme</label>
							<select name="insurance" class="ui dropdown">
								<option value="">Choose One</option>
								<option value="Private Insurance">Private Insurance</option>
								<option value="Public Insurance">Public Insurance</option>
								<option value="No Insurance">No Insurance</option>
								<option value="Undetermined">Undetermined</option>
							</select>
						</div>

						<div class="field">
							<label>Gender</label>
							<select name="Gender" class="ui dropdown">
								<option value="">Choose One</option>
								<option value="Male">Male</option>
								<option value="Female">Female</option>
								<option value="Other">Other</option>
							</select>
						</div>

						<div class="field">
							<label>Age</label>
							<div class="ui right labeled input">
								<input name="Age" type="number" placeholder="Patient Age" min="5">
								<div class="ui basic label">
									yrs
								</div>
							</div>

						</div>

					</div>
				</div>
			</div>

				<div class="ui raised segments">
					<div class="ui segment">
						<div class="ui header">Drug</div>
					</div>
					<div class="ui secondary segment">
						<div class="fields">
							<div class="field">
								<label>Who started the request?</label>
								<select name="firstrequest_starter" class="ui compact dropdown">
									<option value="">Choose One</option>
									<option value="brand patient">brand patient</option>
									<option value="brand prescription">brand prescription</option>
									<option value="inn patient">inn patient</option>
									<option value="inn prescription">inn prescription</option>
								</select>
							</div>

							<div class="field">
								<label>Who makes the final selection for the purchased product?</label>
								<select name="firstsale_driver" class="ui dropdown">
									<option value="">Choose One</option>
									<option value="Patient">Patient</option>
									<option value="Pharmacist">Pharmacist</option>
									<option value="Prescriber">Prescriber</option>
								</select>
							</div>


							<div class="fields">
								<div class="field">
									<label>Was there a switch?</label>
									<select id="switchselect" name="firstswitched" class="ui compact dropdown "
										onchange="//showhideForm(this.value)">
										<option value="">Choose</option>
										<option value="Yes">Yes</option>
										<option value="No">No</option>
									</select>
								</div>

								<div id="leakedfield" class="field">
									<label>Was there a leak?</label>
									<select id="leaked" name="firstleaked" class="ui compact dropdown"
										aria-describedby="leaked-hint ">
										<option value="">Choose</option>
										<option value="Yes">Yes</option>
										<option value="No">No</option>
									</select>
								</div>
							</div>

						</div>

						<div class="fields">
							<div id="drug_sold_field" class="field" style="display:block">
								<label>Brand name of drug that has been sold</label>
								<div class="ui input">
									<input name="firstdrug_sold" type="text" maxlength="200">
								</div>
							</div>

							<div class="field">
								<label>What product was switched or leaked?</label>
								<div class="ui input">
									<input name="firstdrug_switched_leaked" type="text" maxlength="200">
								</div>
							</div>

							<div class="field">
								<label>Was the whole box sold? How was it divided?</label>
								<select name="firstdivision" class="ui dropdown">
									<option value="">Choose One</option>
									<option value="unit">unit</option>
									<option value="blister">blister</option>
									<option value="box">box</option>
									<option value="blister+unit">blister+unit</option>
									<option value="box+unit">box+unit</option>
									<option value="box+blister">box+blister</option>
								</select>
							</div>


						</div id>

						<div class="fields">
							<div class="field">
								<label>Why was there a switch or a leak?</label>
								<select name="firstswitchleak_reason" class="ui dropdown">
									<option value="">Choose One</option>
									<option value="Not available">Not available</option>
									<option value="Price">Price</option>
									<option value="Therapeutic Reason">Therapeutic Reason</option>
									<option value="Other Reason">Other Reason</option>
								</select>
							</div>

							<div class="field">
								<label>What form of drug was sold? liquid,tablet?</label>
								<select name="firstform_sold" class="ui search dropdown">
									<option value="">Choose One</option>
									<option value="3">Capsule</option>
									<option value="7">Cream</option>
									<option value="14">Ear drop</option>
									<option value="15">Eye drop</option>
									<option value="9">Gel</option>
									<option value="12">Inhaler</option>
									<option value="6">Injection</option>
									<option value="8">Ointment</option>
									<option value="10">Patch</option>
									<option value="13">Pessary</option>
									<option value="16">Powder</option>
									<option value="11">Spray</option>
									<option value="1">Suppositories</option>
									<option value="4">Suspension</option>
									<option value="5">Syrup</option>
									<option value="2">Tablet</option>
								</select>
							</div>

						</div>
					</div>
					<div id="drugs"></div>

					<div class="ui segment">
						<button class="ui labeled icon button" onclick="addDrugForm()">
							<i class="plus icon"></i>
							Add Another Drug
						</button>
						<button type="submit" onclick="collectForm()" class="ui labeled icon button">
							Save Basket <i class="icon save right"></i>
						</button>
					</div>
				</div>
			</div>

			<div class="ui horizontal divider">
				<button type="submit" onclick="saveOb()" class="positive ui big submit button">
					Finish <i class="icon arrow right"></i>
				</button>
				<span class="grayed" style="display: none;">
					<i class="ui wait icon"></i>
					Saving.. </span>
			</div>
		</form>
	</div>


	</section>
	<!--/Job posts-section-->

	<script src="https://www.pywe.org/static/js/jquery.min.js"></script>

	<script>
		function saveOb(){
			var session_name = localStorage.getItem('session')
			var session_date = localStorage.getItem('session_date')
			
			db.baskets.toArray(basket => { let usession = basket
				// console.log(session_name)
				// console.log(usession)
				var dsession = {session_name:session_name,date_created:session_date,status:"Local", baskets:usession}
				todb(dsession)
			});
		}

			function todb(dsession){
				db.sessions.put(dsession).then(result => {
   $('body')
				.toast({
					title: 'Success',

					message: 'Your Observation Session is Safe !',
					class: 'orange',
					className: {
						toast: 'ui big message'
					}
				});
				db.baskets.clear()
				window.location.href = "/campaigns/templates/campaigns/new-session.html"
				
   
}).catch(error => {
    console.log ("Error: " + error);
});
			}
			
		function collectForm() {
			myForm = document.getElementById("basketForm");

			var saved = "first";
			let formData = new FormData(myForm);
			var myarray = [];
			var big = {}
			var info = {};
			//This will build the form from name, value pairs

			for (var pair of formData.entries()) {
				var str = pair[0]
				var res = str.substring(0, 5);
				if (window.specials.includes(res)) {
					if (saved === res) {
						var key = (pair[0]).replace(res, "")
						info[key] = pair[1]
					}
					else {
						myarray.push(info)
						var info = {};
						var key = (pair[0]).replace(res, "")
						info[key] = pair[1]
						saved = (pair[0]).substring(0, 5);
					}
				} else {
					big[pair[0]] = pair[1]
				}
			}
			myarray.push(info)
			big['drugs'] = myarray
			console.log(big)
			console.log('Saved Basket')


			db.baskets.add(big); // insert
			//db.simple.add('two'); // insert
			//db.simple.put('three'); // insert    
			//db.simple.put('Three', 3); // update

			//const value = await db.simple.get(3);
			// Three

			//var x = $("snackbar");
			//x.className = "show";
			//setTimeout(function () { x.className = x.className.replace("show", ""); }, 3000);

			$('body')
				.toast({
					title: 'Success',

					message: 'Your Basket is Safe !',
					class: 'orange',
					className: {
						toast: 'ui big message'
					}
				});

		}

	</script>

	<script>
		/*


		function showhideForm(value) {
			if (value == "yes") {
				$('form')
					// set value
					.form('set value', 'leaked', 'No');
				//document.getElementById("div1").style.display = 'block';
				document.getElementById("leakedfield").style.display = 'none';
			}
			if (value == "no") {
				$('form')
					// set value
					.form('set value', 'leaked', 'Yes');
				//document.getElementById("div2").style.display = 'block';
				document.getElementById("drug_sold_field").style.display = 'none';
			}
		}*/
	</script>

	<!-- more -->

	<nav class="fab-container">
		<a id="litbut" href="/campaigns/lockscreen" class="buttons"><i class="sign out icon"></i></a>
		<a id="litbut" href="/campaigns/observation-session" class="buttons"><i class="fa fa-pencil"></i></a>

		<a id="more"><i class="fa fa-plus"></i></a>

	</nav>


	<!-- Back to top -->
	<a href="#top" id="back-to-top"><i class="fa fa-arrow-up"></i></a>

	<!-- JQuery js-->
	<script src="/static/js/vendors/jquery-3.2.1.min.js"></script>



	<!--Semantic js-->
	<!--<script src="/static/plugins/Semantic-UI-CSS/semantic.js"></script>-->
	<script src="/static/plugins/Semantic-UI-CSS/semantic.min.js"></script>

	<!-- Cookie js -->
	<script src="/static/plugins/cookie/jquery.ihavecookies.js"></script>
	<script src="/static/plugins/cookie/cookie.js"></script>

	<!-- Count Down-->
	<script src="/static/plugins/count-down/jquery.lwtCountdown-1.0.js"></script>

	<!-- Ion.RangeSlider -->
	<script src="/static/plugins/jquery-uislider/jquery-ui.js"></script>

	<!-- Custom scroll bar Js-->
	<script src="/static/plugins/scroll-bar/jquery.mCustomScrollbar.concat.min.js"></script>


	<!-- Custom Js-->
	<script src="/static/js/custom.js"></script>

	<script src="/static/js/campaign.js"></script> 

	<script>
		/*$('#switchselect').change(function () {
			//Use $option (with the "$") to see that the variable is a jQuery object
			var $option = $(this).find('option:selected');
			//Added with the EDIT
			var value = $option.val();//to get content of "value" attrib
			var text = $option.text();//to get <option>Text</option> content
			console.log(text)
			function disable() {
				$('.dropdown').dropdown();

				$('.ui.input.sold').addClass("disabled")
			}
			function enable() {
				$('.dropdown').dropdown();

				$('.ui.input.sold').removeClass("disabled")
			}

			if (text == "No") {
				disable()

			} else {
				enable()
			}
		});*/
	</script>

	<script>
		window.specials = ['first']
		function makeid(length) {
			var result = '';
			var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
			var charactersLength = characters.length;
			for (var i = 0; i < length; i++) {
				result += characters.charAt(Math.floor(Math.random() * charactersLength));
			}
			return result;
		}


		function addDrugForm() {
			var id = makeid(5)
			window.specials.push(id)
			$("#drugs").append(`<div class="animated slideInUp" id="` + id + `">
			<div class="ui secondary segment">

				<button onclick="removeDrugForm('`+ id + `')" class="ui left floated red button">Remove</button><hr>
					<div class="fields">
						<div class="field">
							<label>Who started the request?</label>
							<select name="`+ id + `request_starter" class="ui compact dropdown">
								<option value="">Choose One</option>
								<option value="brand patient">brand patient</option>
								<option value="brand prescription">brand prescription</option>
								<option value="inn patient">inn patient</option>
								<option value="inn prescription">inn prescription</option>
							</select>
						</div>

						<div class="field">
							<label>Who makes the final selection for the purchased product?</label>
							<select id ="`+ id + `-sale-driver" name="` + id + `sale_driver" class="ui dropdown" >
								<option value="">Choose One</option>
								<option value="Patient">Patient</option>
								<option value="Pharmacist">Pharmacist</option>
								<option value="Prescriber">Prescriber</option>
							</select>
						</div>


						<div class="fields">
							<div class="field">
								<label>Was there a switch?</label>
								<select name="`+ id + `switched" class="ui compact dropdown "" >
									<option value="">Choose</option>
									<option value="Yes">Yes</option>
									<option value="No">No</option>
								</select>
							</div>

							<div class="field">
								<label>Was there a leak?</label>
								<select name="`+ id + `leaked" class="ui compact dropdown"
									>
									<option value="">Choose</option>
									<option value="Yes">Yes</option>
									<option value="No">No</option>
								</select>
							</div>
						</div>

					</div>

					<div class="fields">
						<div class="field">
							<label>Brand name of drug that has been sold</label>
							<div class="ui input">
								<input name="`+ id + `drug_sold" type="text" maxlength="200" >
							</div>
						</div>

						<div class="field">
							<label>What product was switched or leaked?</label>
							<div class="ui input">
								<input name="`+ id + `drug_switched_leaked" type="text" maxlength="200" >
							</div>
						</div>

						<div class="field">
							<label>Was the whole box sold? How was it divided?</label>
							<select name="`+ id + `division" class="ui dropdown" >
								<option value="">Choose One</option>
								<option value="unit">unit</option>
								<option value="blister">blister</option>
								<option value="box">box</option>
								<option value="blister+unit">blister+unit</option>
								<option value="box+unit">box+unit</option>
								<option value="box+blister">box+blister</option>
							</select>
						</div>


					</div>

					<div class="fields">
						<div class="field">
							<label>Why was there a switch or a leak?</label>
							<select switchleak-reason" name="`+ id + `switchleak_reason" class="ui dropdown" >
								<option value="">Choose One</option>
								<option value="Not available">Not available</option>
								<option value="Price">Price</option>
								<option value="Therapeutic Reason">Therapeutic Reason</option>
								<option value="Other Reason">Other Reason</option>
							</select>
						</div>

						<div class="field">
							<label>What form of drug was sold? liquid,tablet?</label>
							<select name="`+ id + `form_sold" class="ui search dropdown" >
								<option value="">Choose One</option>
								<option value="3">Capsule</option>
								<option value="7">Cream</option>
								<option value="14">Ear drop</option>
								<option value="15">Eye drop</option>
								<option value="9">Gel</option>
								<option value="12">Inhaler</option>
								<option value="6">Injection</option>
								<option value="8">Ointment</option>
								<option value="10">Patch</option>
								<option value="13">Pessary</option>
								<option value="16">Powder</option>
								<option value="11">Spray</option>
								<option value="1">Suppositories</option>
								<option value="4">Suspension</option>
								<option value="5">Syrup</option>
								<option value="2">Tablet</option>
							</select>
						</div>

					</div>
				</div></div>`);
			$('#drugs .ui.dropdown')
				.dropdown({ on: 'click' });






		}
		function removeDrugForm(id) {
			$("#" + id).transition('fade')
				.remove();
			// document.getElementById(id).style.display = "none"
		}

		function submitForm() {



			const data = collectForm()
			// Make a request to add our newItem object to the object store
			/*var objectStoreRequest = basketStore.add(big);

			objectStoreRequest.onsuccess = function (event) {
				// report the success of our request
				function toast(msg, time) {
					var x = document.getElementById("snackbar");

					x.innerHTML += '<p>successful.</p>' = msg;
					x.className = "show";
					setTimeout(function () { x.className = x.className.replace("show", ""); }, time);
				}
			}*/
		}
	</script>
</body>

</html>